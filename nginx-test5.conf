server {
    listen 80;
    server_name localhost;

    # ตั้งค่า root สำหรับไฟล์ static 
    root /usr/share/nginx/html; 

    # Redirect root / ไปยัง /test5
    location / {
        return 302 /test5;
    }
    
    # จัดการการเข้าถึง /test5 และไฟล์อื่นๆ ใน public/
    location /test5 {
        alias /usr/share/nginx/html/public;
        index test5.html;
        try_files $uri $uri/ /test5.html; /* ใช้สำหรับ SPA */
    }
    
    # ส่งต่อ requests ที่ขึ้นต้นด้วย /test5/api/ ไปยัง Backend Node.js
    location /test5/api/ {
        # proxy_pass ไปยังชื่อบริการ 'app' และพอร์ต 1040 ใน docker-compose
        proxy_pass http://app:1040/test5/api/; 
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}